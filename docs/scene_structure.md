# MG-0002 고양이 연금술 공방 - 씬 구성 및 플로우

> **작성일**: 2025-12-17
> **목적**: 게임의 모든 씬(화면) 구조와 전환 플로우 정의

---

## 목차

1. [씬 아키텍처 개요](#1-씬-아키텍처-개요)
2. [씬 목록 및 계층](#2-씬-목록-및-계층)
3. [씬 전환 플로우](#3-씬-전환-플로우)
4. [씬별 상세 구성](#4-씬별-상세-구성)
5. [UI 컴포넌트 라이브러리](#5-ui-컴포넌트-라이브러리)
6. [씬 상태 관리](#6-씬-상태-관리)

---

## 1. 씬 아키텍처 개요

### 1.1 씬 분류 체계

```
┌─────────────────────────────────────────────────────────────────┐
│                       씬 아키텍처                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [레벨 1] 앱 루트                                               │
│      └── SplashScene (앱 시작)                                  │
│                                                                 │
│  [레벨 2] 인증/온보딩                                           │
│      ├── TutorialScene (신규 유저)                              │
│      └── LoginScene (복귀 유저, 클라우드 백업 선택)              │
│                                                                 │
│  [레벨 3] 메인 게임 (탭 네비게이션)                             │
│      ├── HomeScene (공방 메인)                                  │
│      ├── CraftingScene (제작)                                   │
│      ├── OrdersScene (주문)                                     │
│      ├── CodexScene (도감)                                      │
│      └── CatScene (고양이)                                      │
│                                                                 │
│  [레벨 4] 모달 오버레이                                         │
│      ├── InventoryModal                                        │
│      ├── UpgradeModal                                          │
│      ├── RecipeDetailModal                                     │
│      ├── OrderDetailModal                                      │
│      ├── SettingsModal                                         │
│      └── ShopModal (Post-MVP)                                  │
│                                                                 │
│  [레벨 5] 전체 화면 특수 씬                                      │
│      ├── RecipeDiscoveryScene (발견 연출)                       │
│      ├── LevelUpScene (레벨업 연출)                             │
│      └── EndingScene (엔딩)                                     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 씬 전환 원칙

| 원칙 | 설명 |
|------|------|
| **탭 기반 네비게이션** | 메인 5개 씬은 하단 탭으로 즉시 전환 |
| **모달은 스택** | 모달은 현재 씬 위에 오버레이, Back 버튼으로 닫기 |
| **전체 화면은 푸시** | 특수 씬은 전체 화면 전환, 애니메이션 포함 |
| **상태 보존** | 씬 전환 시 이전 씬 상태 유지 (탭 재진입 시 복원) |
| **로딩 최소화** | 씬 프리로드로 전환 속도 최적화 |

---

## 2. 씬 목록 및 계층

### 2.1 전체 씬 목록 (MVP)

| ID | 씬 이름 | 타입 | 우선순위 | 예상 개발 시간 |
|----|---------|------|----------|----------------|
| S01 | SplashScene | 루트 | P0 | 0.5일 |
| S02 | TutorialScene | 온보딩 | P0 | 3일 |
| S03 | HomeScene | 메인탭 | P0 | 4일 |
| S04 | CraftingScene | 메인탭 | P0 | 5일 |
| S05 | OrdersScene | 메인탭 | P0 | 4일 |
| S06 | CodexScene | 메인탭 | P0 | 3일 |
| S07 | CatScene | 메인탭 | P0 | 3일 |
| S08 | InventoryModal | 모달 | P0 | 2일 |
| S09 | UpgradeModal | 모달 | P0 | 2일 |
| S10 | RecipeDetailModal | 모달 | P1 | 1일 |
| S11 | OrderDetailModal | 모달 | P1 | 1일 |
| S12 | SettingsModal | 모달 | P1 | 1.5일 |
| S13 | RecipeDiscoveryScene | 특수 | P0 | 2일 |
| S14 | LevelUpScene | 특수 | P1 | 1.5일 |
| S15 | EndingScene | 특수 | P2 | 2일 |
| S16 | LoginScene | 온보딩 | P2 (Post-MVP) | 2일 |

**총 개발 시간**: ~37.5 인일

### 2.2 씬 계층 다이어그램

```
AppRoot
  │
  ├─ SplashScene (앱 시작)
  │    └─> [신규] TutorialScene
  │    └─> [복귀] MainTabContainer
  │
  ├─ TutorialScene (튜토리얼)
  │    └─> MainTabContainer (완료 시)
  │
  └─ MainTabContainer ★ (메인 게임)
       │
       ├─ Tab1: HomeScene
       │    ├─> UpgradeModal
       │    └─> InventoryModal
       │
       ├─ Tab2: CraftingScene
       │    ├─> RecipeDetailModal
       │    ├─> InventoryModal
       │    └─> RecipeDiscoveryScene (발견 시)
       │
       ├─ Tab3: OrdersScene
       │    ├─> OrderDetailModal
       │    └─> InventoryModal
       │
       ├─ Tab4: CodexScene
       │    └─> RecipeDetailModal
       │
       └─ Tab5: CatScene
            └─> MiniGameScene (Post-MVP)

       [공통 모달]
       ├─> SettingsModal (상단 햄버거 메뉴)
       ├─> ShopModal (상단 젬 버튼)
       └─> LevelUpScene (레벨업 시 자동)
```

---

## 3. 씬 전환 플로우

### 3.1 앱 시작 플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                      앱 시작 플로우                              │
└─────────────────────────────────────────────────────────────────┘

[앱 실행]
    │
    v
┌─────────────────┐
│ SplashScene     │  (1-2초)
│ - 로고 표시     │
│ - 리소스 로딩   │
└─────────────────┘
    │
    v
<저장 데이터 확인>
    │
    ├─── [신규 유저] ───> ┌─────────────────┐
    │                     │ TutorialScene   │ (5분)
    │                     │ - Step 1-5      │
    │                     └─────────────────┘
    │                             │
    │                             v
    │                     <튜토리얼 완료>
    │                             │
    └─── [복귀 유저] ─────────────┴───> ┌─────────────────┐
                                         │ MainTabContainer│
                                         │ (HomeScene)     │
                                         └─────────────────┘
                                                 │
                                                 v
                                         <오프라인 보상 팝업>
                                                 │
                                                 v
                                         <정상 플레이>
```

### 3.2 메인 게임 탭 전환 플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                    메인 탭 네비게이션                            │
└─────────────────────────────────────────────────────────────────┘

┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐     ┌──────────┐
│  Home    │ ←→ │ Crafting │ ←→ │  Orders  │ ←→ │  Codex   │ ←→ │   Cat    │
│  공방    │     │   제작   │     │   주문   │     │  도감    │     │  고양이  │
└──────────┘     └──────────┘     └──────────┘     └──────────┘     └──────────┘
     ↑                ↑                 ↑                ↑                 ↑
     └────────────────┴─────────────────┴────────────────┴─────────────────┘
                    하단 탭 바 (항상 표시, 즉시 전환)

[전환 규칙]
├── 탭 클릭 → 0.2초 페이드 전환
├── 이전 씬 상태 유지 (메모리에 캐시)
├── 재진입 시 이전 스크롤 위치 복원
└── 배지 알림 표시 (새 재료, 제작 완료 등)
```

### 3.3 제작 → 발견 플로우 (핵심 경험)

```
┌─────────────────────────────────────────────────────────────────┐
│                  레시피 발견 플로우                              │
└─────────────────────────────────────────────────────────────────┘

[CraftingScene]
    │
    │ (사용자가 자유 제작 모드에서 재료 조합)
    v
┌───────────────────┐
│ 재료 슬롯 UI      │
│ [🌿] [💧] [+] [+] │
└───────────────────┘
    │
    │ "제작 시도" 버튼 클릭
    v
<조합 검증>
    │
    ├─── [실패] ───> "이상한 냄새만 나네요..." 토스트 메시지
    │                      │
    │                      v
    │                 (CraftingScene 유지, 재시도 가능)
    │
    └─── [성공] ───> ┌─────────────────────────────────┐
                     │ RecipeDiscoveryScene (전체화면) │
                     │                                 │
                     │ 1. 가마솥 빛나는 애니메이션      │
                     │ 2. 새 레시피 아이콘 확대 등장    │
                     │ 3. "새로운 레시피 발견!"         │
                     │ 4. 레시피 상세 정보 표시         │
                     │ 5. 보상 연출 (골드, 경험치)      │
                     │                                 │
                     │ [확인] 버튼                      │
                     └─────────────────────────────────┘
                              │
                              v
                     <도감에 자동 등록>
                              │
                              v
                     (CraftingScene으로 복귀)
                              │
                              v
                     <발견한 레시피로 즉시 제작 가능>
```

### 3.4 주문 완료 플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                     주문 완료 플로우                             │
└─────────────────────────────────────────────────────────────────┘

[OrdersScene]
    │
    │ (주문 카드 클릭)
    v
┌──────────────────┐
│ OrderDetailModal │ (모달 오버레이)
│                  │
│ - 고객 정보      │
│ - 요청 아이템    │
│ - 보상          │
│ - 남은 시간      │
│                  │
│ [납품하기] 버튼  │
└──────────────────┘
    │
    │ 버튼 클릭
    v
<인벤토리 검증>
    │
    ├─── [재료 부족] ───> "재료가 부족합니다" 토스트
    │                          │
    │                          v
    │                    [수집하러 가기] 버튼 표시
    │                          │
    │                          v
    │                    (CraftingScene으로 전환)
    │
    └─── [재료 충분] ───> <아이템 차감>
                              │
                              v
                         ┌─────────────────┐
                         │ 보상 연출        │
                         │ - 골드 코인 파티클│
                         │ - 평판 상승 표시 │
                         │ - "+150 💰" 텍스트│
                         └─────────────────┘
                              │
                              v
                         <주문 목록에서 제거>
                              │
                              v
                         (OrdersScene 갱신)
                              │
                              v
                         <다음 주문 자동 추가 체크>
```

### 3.5 공방 업그레이드 플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                   공방 업그레이드 플로우                         │
└─────────────────────────────────────────────────────────────────┘

[HomeScene]
    │
    │ "업그레이드" 버튼 클릭
    v
┌──────────────────┐
│ UpgradeModal     │ (모달)
│                  │
│ 현재 Lv: 5       │
│ 다음 Lv: 6       │
│                  │
│ [효과 미리보기]  │
│ - 제작 대기열 +1 │
│                  │
│ 필요 골드: 8,000 │
│ 보유: 12,450 ✅  │
│                  │
│ [업그레이드]     │
└──────────────────┘
    │
    │ 버튼 클릭
    v
<골드 차감>
    │
    v
<레벨업 처리>
    │
    v
┌──────────────────┐
│ LevelUpScene     │ (전체 화면, 2초)
│                  │
│ 🎉 레벨 6 달성!  │
│                  │
│ [해금된 효과]    │
│ 제작 대기열 +1   │
│                  │
│ 보상:            │
│ 💎 젬 × 10       │
└──────────────────┘
    │
    │ (자동으로 2초 후 닫힘)
    v
(HomeScene으로 복귀)
    │
    v
<UI 갱신: 새 레벨 반영>
```

---

## 4. 씬별 상세 구성

### S01: SplashScene

#### 4.1.1 목적
- 앱 초기 로딩
- 브랜드 인지
- 리소스 프리로드

#### 4.1.2 구성 요소

```
┌─────────────────────────────────────────────────────────────────┐
│                         SplashScene                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                                                                 │
│                      [로고 이미지]                              │
│                   "고양이 연금술 공방"                           │
│                                                                 │
│                                                                 │
│                  ▓▓▓▓▓▓▓▓▓░░░░░░                                │
│                 로딩 중... 65%                                   │
│                                                                 │
│                                                                 │
│                    ver 1.0.0                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.1.3 로딩 단계

| 단계 | 작업 | 진행률 |
|------|------|--------|
| 1 | 로컬 저장 데이터 로드 | 0-20% |
| 2 | 공통 모듈 초기화 | 20-40% |
| 3 | 게임 데이터 (레시피 JSON) 로드 | 40-60% |
| 4 | 필수 이미지 프리로드 | 60-80% |
| 5 | 사운드 초기화 | 80-90% |
| 6 | 오프라인 보상 계산 | 90-100% |

#### 4.1.4 전환 조건

```dart
if (isFirstLaunch) {
  Navigator.pushReplacement(context, TutorialScene());
} else {
  Navigator.pushReplacement(context, MainTabContainer());
}
```

---

### S02: TutorialScene

#### 4.2.1 목적
- 신규 유저에게 코어 루프 교육
- 첫 레시피 발견 경험 제공
- 기본 UI 사용법 안내

#### 4.2.2 튜토리얼 단계

```
┌─────────────────────────────────────────────────────────────────┐
│                   튜토리얼 5단계 구조                            │
└─────────────────────────────────────────────────────────────────┘

┌──────────────┐
│ Step 1       │ (30초)
│ 환영 & 소개  │
├──────────────┤
│ - 모카 등장  │
│ - "환영해요!"│
│ - 공방 배경  │
└──────────────┘
      ↓
┌──────────────┐
│ Step 2       │ (1분)
│ 재료 수집    │
├──────────────┤
│ - "수집터" 탭│
│ - 재료 수령  │
│ - 인벤토리   │
└──────────────┘
      ↓
┌──────────────┐
│ Step 3       │ (1분)
│ 첫 제작      │
├──────────────┤
│ - "제작" 탭  │
│ - 레시피 선택│
│ - 제작 시작  │
│ - 완성 수령  │
└──────────────┘
      ↓
┌──────────────┐
│ Step 4       │ (30초)
│ 판매         │
├──────────────┤
│ - "주문" 탭  │
│ - 첫 주문    │
│ - 납품       │
│ - 골드 획득  │
└──────────────┘
      ↓
┌──────────────┐
│ Step 5       │ (1분)
│ 업그레이드   │
├──────────────┤
│ - "공방" 탭  │
│ - 레벨업     │
│ - 효과 설명  │
│ - 무료 업그레│
└──────────────┘
      ↓
<튜토리얼 완료>
      ↓
[메인 게임 시작]
```

#### 4.2.3 Step 1 상세 구성

```
┌─────────────────────────────────────────────────────────────────┐
│                    Tutorial Step 1: 환영                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    [공방 배경 일러스트]                         │
│                                                                 │
│              🐱                                                 │
│            (모카)                                               │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                                                           │ │
│  │  "안녕하세요! 저는 모카예요. 🐾"                          │ │
│  │  "당신의 연금술 공방을 함께 운영하게 되었어요!"            │ │
│  │                                                           │ │
│  │                                    [다음] ───────────>    │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│                                                                 │
│                         ●○○○○                                  │
│                       (진행 표시)                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.2.4 튜토리얼 UI 가이드 시스템

```
[가이드 오버레이]
├── 반투명 검은 레이어 (나머지 화면 어둡게)
├── 포커스 영역 하이라이트 (밝게)
├── 화살표 애니메이션 (포커스 영역 가리키기)
└── 말풍선 텍스트 (간결한 설명)

예시:
"여기를 탭해서 재료를 수령하세요!"
     ↓ (화살표)
   [재료 수령 버튼] ← 하이라이트
```

#### 4.2.5 스킵 옵션

```
[상단 우측]
└── "건너뛰기" 버튼
    │
    v
  <확인 대화상자>
    │
    ├─ [예] → 메인 게임으로 (보상 없음)
    └─ [아니오] → 튜토리얼 계속
```

---

### S03: HomeScene (공방 메인)

#### 4.3.1 목적
- 게임의 홈 베이스
- 전체 현황 한눈에 파악
- 주요 액션 빠른 접근

#### 4.3.2 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  [☰]  고양이 연금술 공방          [💰 12,450]  [💎 50]  [⚙️]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    [공방 내부 일러스트]                         │
│                                                                 │
│                  ┌─────────────────────┐                       │
│                  │      🧪 가마솥       │                       │
│                  │                     │                       │
│                  │   제작 중: 2/3      │  ← 탭하면 제작 화면   │
│                  │   ⏱️ 가장 빠른 완료  │                       │
│                  │   00:15:30          │                       │
│                  └─────────────────────┘                       │
│                                                                 │
│        🐱 [모카]  Lv.3                  ← 탭하면 고양이 화면   │
│      (Idle 애니메이션)                                          │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │ 📦 재료 수집터                              [새 재료 12] │  │
│  │ "오프라인 동안 재료가 모였어요!"                         │  │
│  │ [수령하기] ─────────────────────────────────────────>    │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │ 📋 대기 중인 주문 (3)                        [보기 >]   │  │
│  │ 👨‍🌾 농부 톰: 치유 물약 × 3 (⏱️ 00:45:00)                │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐  │
│  │ ⚙️ 공방 레벨                                            │  │
│  │ 현재: Lv.5  다음: Lv.6 (필요 골드: 8,000)               │  │
│  │ ■■■■■■■■□□ 65%                                       │  │
│  │                              [업그레이드] ────────────>  │  │
│  └─────────────────────────────────────────────────────────┘  │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.3.3 구성 요소 목록

| 요소 ID | 이름 | 기능 | 인터랙션 |
|---------|------|------|----------|
| H-01 | 상단 바 | 타이틀, 재화 표시, 설정 | 재화 탭→ShopModal, ⚙️→SettingsModal |
| H-02 | 공방 배경 | 시각적 분위기 | 패럴랙스 스크롤 |
| H-03 | 가마솥 위젯 | 제작 현황 표시 | 탭→CraftingScene |
| H-04 | 고양이 캐릭터 | 도우미, 애니메이션 | 탭→CatScene, 길게 누르기→쓰다듬기 |
| H-05 | 재료 수집 배너 | 오프라인 보상 알림 | 탭→수령 애니메이션→InventoryModal |
| H-06 | 주문 요약 | 대기 주문 미리보기 | 탭→OrdersScene |
| H-07 | 공방 업그레이드 | 레벨/진행도 표시 | 탭→UpgradeModal |
| H-08 | 하단 탭 바 | 메인 네비게이션 | 탭 전환 |

#### 4.3.4 상태별 UI 변화

```
[오프라인 복귀 시]
├── 재료 수집 배너 활성화
├── 제작 완료 아이템 알림 배지
└── 새 주문 도착 알림

[제작 중일 때]
├── 가마솥에서 연기 파티클
├── 타이머 실시간 업데이트
└── 완료 시 "띠링!" 사운드 + 알림

[레벨업 가능 시]
├── 업그레이드 버튼 펄스 애니메이션
└── "레벨업 가능!" 배지
```

---

### S04: CraftingScene (제작)

#### 4.4.1 목적
- 레시피 제작
- 새 레시피 발견 (자유 제작)
- 제작 대기열 관리

#### 4.4.2 화면 구성 (레시피 모드)

```
┌─────────────────────────────────────────────────────────────────┐
│  ← 제작                                    [💰 12,450]  [💎 50] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────────────┐  ┌────────────────┐                        │
│  │ [레시피 모드]  │  │  자유 제작     │   ← 탭 전환            │
│  └────────────────┘  └────────────────┘                        │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  제작 대기열 (2/3)                                              │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐            │
│  │ 💚 치유물약  │  │ 💙 마나물약  │  │    [+]      │            │
│  │             │  │             │  │             │            │
│  │ ⏱️ 00:00:15  │  │ ⏱️ 00:01:30  │  │  새 제작    │            │
│  │             │  │             │  │             │            │
│  │ [수령하기]  │  │  제작 중...  │  │             │            │
│  └─────────────┘  └─────────────┘  └─────────────┘            │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📜 발견한 레시피 (12/38)                                       │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  [Tier 1 ▼]  [물약 ▼]  [이름순 ▼]   ← 필터/정렬               │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │ 💚       │  │ 💙       │  │ ⚡       │  │ 🏃       │      │
│  │ 치유물약  │  │ 마나물약  │  │ 활력물약  │  │ 신속물약  │      │
│  │          │  │          │  │          │  │          │      │
│  │ 🌿×2 💧×1 │  │ 🌸×1 💦×1 │  │ 🪵×2 💧×1 │  │ 🌸×2 💦×1 │      │
│  │ ⏱️ 30초   │  │ ⏱️ 45초   │  │ ⏱️ 1분    │  │ ⏱️ 2분    │      │
│  │ 💰 50    │  │ 💰 80    │  │ 💰 60    │  │ 💰 150   │      │
│  │          │  │          │  │          │  │          │      │
│  │ [제작]   │  │ [제작]   │  │ [제작]   │  │ [제작]   │      │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ... (스크롤 가능)                 │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🔒 미발견 레시피 (26)                                          │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                    │
│  │ ❓       │  │ ❓       │  │ ❓       │                    │
│  │ ???      │  │ ???      │  │ ???      │                    │
│  │          │  │          │  │          │                    │
│  │ Tier 2   │  │ Tier 2   │  │ Tier 3   │                    │
│  │          │  │          │  │          │                    │
│  │ [힌트]💎 │  │ [힌트]💎 │  │ [힌트]💎 │                    │
│  └──────────┘  └──────────┘  └──────────┘                    │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.4.3 화면 구성 (자유 제작 모드)

```
┌─────────────────────────────────────────────────────────────────┐
│  ← 제작                                    [💰 12,450]  [💎 50] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────────────┐  ┌────────────────┐                        │
│  │  레시피 모드   │  │ [자유 제작]    │   ← 탭 전환            │
│  └────────────────┘  └────────────────┘                        │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🧪 자유 제작 - 새로운 레시피를 발견하세요!                     │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│                    [가마솥 일러스트]                            │
│                                                                 │
│  재료 슬롯                                                      │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐  │
│  │ 🌿 들풀    │  │ 💧 맑은물  │  │   [+]     │  │   [+]     │  │
│  │           │  │           │  │           │  │           │  │
│  │ 보유: 45  │  │ 보유: 23  │  │ 재료 추가 │  │ 재료 추가 │  │
│  │           │  │           │  │           │  │           │  │
│  │  [✖️ 제거] │  │  [✖️ 제거] │  │           │  │           │  │
│  └───────────┘  └───────────┘  └───────────┘  └───────────┘  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                                                           │ │
│  │                  [🧪 제작 시도]                           │ │
│  │         (새로운 레시피를 발견할 수 있습니다)               │ │
│  │                                                           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  💡 발견 도움말                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  • 식물 계열 + 액체 = 물약의 기본!                              │
│  • 2-4개 재료를 자유롭게 조합해보세요                           │
│  • 실패해도 재료가 소모되지 않아요                              │
│  • 운이 좋으면 보너스 보상도!                                   │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📊 발견 기록                                                   │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  오늘 발견: 2개  |  총 발견: 12/38 (31%)                        │
│                                                                 │
│  최근 발견:                                                     │
│  • 💚 치유 물약 (30분 전)                                       │
│  • 💙 마나 물약 (2시간 전)                                      │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.4.4 인터랙션 플로우

**[레시피 제작]**

```
1. 레시피 카드 탭
   │
   v
2. RecipeDetailModal 팝업
   │
   ├─ 재료 확인
   ├─ 제작 시간 확인
   └─ 판매가 확인
   │
   v
3. [제작] 버튼 클릭
   │
   v
4. <인벤토리 검증>
   │
   ├─ [부족] → "재료가 부족합니다" 토스트
   │              └─> [수집하러 가기] 버튼
   │
   └─ [충분] → <재료 차감>
                │
                v
              <대기열 추가>
                │
                v
              "제작 시작!" 토스트
                │
                v
              (화면 상단 대기열 갱신)
```

**[자유 제작]**

```
1. [+] 슬롯 탭
   │
   v
2. InventoryModal 팝업 (재료만 필터)
   │
   v
3. 재료 선택 (복수 가능)
   │
   v
4. 슬롯에 추가 (최대 4개)
   │
   v
5. [제작 시도] 버튼 클릭
   │
   v
6. <조합 검증>
   │
   ├─ [실패] → 가마솥 "퐁!" 애니메이션
   │            │
   │            v
   │          "이상한 냄새만 나네요..." 토스트
   │            │
   │            v
   │          슬롯 초기화 (재료 반환)
   │
   └─ [성공] → 가마솥 빛나는 효과
                │
                v
              RecipeDiscoveryScene 전환 ★
                │
                v
              <도감 등록>
                │
                v
              <보상 지급>
                │
                v
              (CraftingScene 복귀)
```

---

### S05: OrdersScene (주문)

#### 4.5.1 목적
- 고객 주문 확인 및 납품
- 골드 & 평판 획득
- 목표 지향 플레이 유도

#### 4.5.2 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  ← 주문                                    [💰 12,450]  [💎 50] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ⭐ 오늘의 특별 주문                                             │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                                                           │ │
│  │  🧙‍♀️ 신비한 손님                                           │ │
│  │                                                           │ │
│  │  "전설의 물약을 구합니다..."                               │ │
│  │                                                           │ │
│  │  📦 요청: 생명의 영약 × 1                                  │ │
│  │  💰 보상: 5,000 골드                                      │ │
│  │  💎 보너스: 젬 × 50                                       │ │
│  │  ⭐ 평판: +50                                             │ │
│  │                                                           │ │
│  │  ⏱️ 남은 시간: 11:30:00                                    │ │
│  │  ■■■■■■■■□□ 75%                                        │ │
│  │                                                           │ │
│  │  [납품하기] (비활성 - 재료 부족)                           │ │
│  │  필요 아이템: 생명의 영약 × 1 (보유: 0) ❌                 │ │
│  │                                                           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📋 일반 주문 (2/3)                                             │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌─────────────────────┐  ┌─────────────────────┐            │
│  │ 👨‍🌾 농부 톰          │  │ ⚔️ 기사 카일        │            │
│  │                     │  │                     │            │
│  │ "농장에서 다쳤어요" │  │ "전투 준비 중..."   │            │
│  │                     │  │                     │            │
│  │ 📦 치유 물약 × 3     │  │ 📦 힘 물약 × 2      │            │
│  │ 💰 150G             │  │ 💰 400G             │            │
│  │ ⭐ +5               │  │ ⭐ +8               │            │
│  │                     │  │                     │            │
│  │ ⏱️ 00:45:00          │  │ ⏱️ 02:30:00          │            │
│  │                     │  │                     │            │
│  │ [납품하기] ✅       │  │ [납품하기]          │            │
│  │                     │  │                     │            │
│  └─────────────────────┘  └─────────────────────┘            │
│                                                                 │
│  ┌─────────────────────┐                                      │
│  │     [빈 슬롯]        │                                      │
│  │                     │                                      │
│  │  새 주문 도착까지    │                                      │
│  │   ⏱️ 00:15:00        │                                      │
│  │                     │                                      │
│  └─────────────────────┘                                      │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📊 주문 통계                                                   │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  오늘 완료: 5개  |  총 완료: 127개  |  평판: 450/1000 (전문가) │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.5.3 주문 카드 상태

| 상태 | 표시 | 버튼 |
|------|------|------|
| **납품 가능** | 녹색 테두리, ✅ 아이콘 | [납품하기] (활성) |
| **재료 부족** | 회색 테두리, ❌ 아이콘 | [납품하기] (비활성) |
| **시간 임박** | 빨간 테두리, 타이머 펄스 | [납품하기] (강조) |
| **시간 초과** | 어두운 배경, "실패" 표시 | [확인] (주문 제거) |

#### 4.5.4 납품 플로우

```
1. 주문 카드 탭
   │
   v
2. OrderDetailModal 팝업
   │
   ├─ 고객 초상화 & 스토리
   ├─ 요청 아이템 상세
   ├─ 보상 상세
   └─ 타이머
   │
   v
3. [납품하기] 버튼 클릭
   │
   v
4. <확인 대화상자>
   "정말 납품하시겠습니까?"
   [취소] [확인]
   │
   v
5. <인벤토리 차감>
   │
   v
6. ★ 보상 연출 ★
   │
   ├─ 골드 코인 파티클 (화면 중앙 → 상단 골드 UI)
   ├─ "+150 💰" 텍스트 애니메이션
   ├─ "+5 ⭐" 평판 상승
   └─ 고객 대사 말풍선 "고마워요!"
   │
   v
7. <주문 카드 제거>
   │
   v
8. (OrdersScene 갱신)
```

---

### S06: CodexScene (도감)

#### 4.6.1 목적
- 발견한 레시피 확인
- 미발견 레시피 힌트
- 컬렉션 완성도 확인

#### 4.6.2 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  ← 레시피 도감                              [💰 12,450]  [💎 50] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐       │
│  │ [전체] │ │  물약  │ │  폭탄  │ │  특수  │ │  전설  │       │
│  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘       │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📊 수집 진행도                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  발견: 12 / 38 (31%)                                            │
│  ■■■■■□□□□□□□□□□□                                      │
│                                                                 │
│  Tier 1: 10/15  ■■■■■■□□  |  Tier 2: 2/12  ■□□□□□       │
│  Tier 3: 0/8    □□□□□□□□  |  전설: 0/3    □□□           │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  [정렬: 최신순 ▼]  [필터: 발견함 ▼]                             │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ 💚 하급 치유 물약                                  ⭐수집  │ │
│  │ Tier 1                                                    │ │
│  │                                                           │ │
│  │ 재료: 🌿 들풀 × 2, 💧 맑은 물 × 1                          │ │
│  │ 제작 시간: 30초                                            │ │
│  │ 판매가: 💰 50                                             │ │
│  │                                                           │ │
│  │ "기본적인 상처를 치유하는 물약. 연금술의 시작."              │ │
│  │                                                           │ │
│  │ ┌─────────────────────────────────────────────────────┐  │ │
│  │ │ 📊 제작 통계                                        │  │ │
│  │ │ • 제작 횟수: 23회                                    │  │ │
│  │ │ • 총 판매 골드: 1,150 💰                            │  │ │
│  │ │ • 첫 발견: 3일 전                                    │  │ │
│  │ │ • 마지막 제작: 1시간 전                              │  │ │
│  │ └─────────────────────────────────────────────────────┘  │ │
│  │                                                           │ │
│  │ [제작하기] [공유]                                         │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ 💙 하급 마나 물약                                  ⭐수집  │ │
│  │ Tier 1                                                    │ │
│  │ ... (접혀있음, 탭하여 확장)                                │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ ❓ 미발견 레시피                                   💡힌트  │ │
│  │ Tier 2                                                    │ │
│  │                                                           │ │
│  │ 카테고리: 물약                                             │ │
│  │                                                           │ │
│  │ ┌─────────────────────────────────────────────────────┐  │ │
│  │ │ 🔒 힌트 (10 💎 또는 광고 시청)                      │  │ │
│  │ │                                                     │  │ │
│  │ │ "식물 × 2, 액체 × 1, 광물 × 1"                     │  │ │
│  │ │ "마법의 힘을 회복시킨다..."                         │  │ │
│  │ └─────────────────────────────────────────────────────┘  │ │
│  │                                                           │ │
│  │ [힌트 보기] [자유 제작하러 가기]                           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ... (스크롤 계속)                                              │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.6.3 필터 & 정렬 옵션

**[필터]**

```
┌───────────────┐
│ 전체 표시      │ ← 기본
├───────────────┤
│ 발견한 것만    │
├───────────────┤
│ 미발견만       │
├───────────────┤
│ Tier 1        │
├───────────────┤
│ Tier 2        │
├───────────────┤
│ Tier 3        │
├───────────────┤
│ 전설          │
└───────────────┘
```

**[정렬]**

```
┌───────────────┐
│ 최신순 (발견)  │ ← 기본
├───────────────┤
│ 오래된 순      │
├───────────────┤
│ 이름 가나다순  │
├───────────────┤
│ Tier 낮은 순   │
├───────────────┤
│ Tier 높은 순   │
├───────────────┤
│ 제작 횟수 많은 순│
└───────────────┘
```

---

### S07: CatScene (고양이)

#### 4.7.1 목적
- 고양이 조수 상호작용
- 신뢰도 & 레벨 관리
- 힐링 콘텐츠

#### 4.7.2 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  ← 고양이 조수                              [💰 12,450]  [💎 50] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                                                                 │
│                  🐱 모카 (Moca)                                 │
│                                                                 │
│            [큰 고양이 일러스트]                                  │
│          (탭하여 쓰다듬기 - 오늘 5/10)                           │
│                                                                 │
│            💭 "냐옹~ 오늘 기분이 좋아요!"                        │
│                                                                 │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ 레벨: 3 / 10                                  [경험치 내역]│ │
│  │ 신뢰도: 250 / 300 (다음 레벨까지 50)                       │ │
│  │ ■■■■■■■■■□ 83%                                        │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🎁 모카의 효과                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐             │
│  │ 재료 수집    │ │ 제작 시간    │ │ 주문 골드    │             │
│  │             │ │             │ │             │             │
│  │   +15%      │ │   -8%       │ │   +5%       │             │
│  │             │ │             │ │             │             │
│  │ Lv.2 달성   │ │ Lv.2 달성   │ │ Lv.1 기본   │             │
│  └─────────────┘ └─────────────┘ └─────────────┘             │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🌟 스킬 트리                                                   │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  Lv.1 ✅ 수집 +10%         Lv.6 🔒 제작 대기열 +1               │
│  Lv.2 ✅ 제작 -5%          Lv.7 🔒 평판 보너스 +10%             │
│  Lv.3 ✅ 판매가 +5%        Lv.8 🔒 ???                          │
│  Lv.4 🔒 오프라인 보상     Lv.9 🔒 ???                          │
│  Lv.5 🔒 제작 대기열 +1    Lv.10 🔒 행운의 발                   │
│                                                                 │
│  다음 스킬 해금까지: 50 신뢰도                                   │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  💖 상호작용                                                    │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ 쓰다듬기 (오늘 5/10)                                       │ │
│  │ 모카를 탭해서 쓰다듬어 주세요!                              │ │
│  │ 신뢰도 +1 / 하루 10회 제한                                 │ │
│  │                                                           │ │
│  │ 다음 쓰다듬기까지: 즉시 가능                                │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ [🎮 함께 놀기] (오늘 2/3)                                  │ │
│  │                                                           │ │
│  │ 미니게임으로 모카와 즐거운 시간을 보내세요                  │ │
│  │ 신뢰도 +10 / 하루 3회 제한                                 │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ [🍖 간식 주기] (광고 시청)                                 │ │
│  │                                                           │ │
│  │ 모카가 좋아하는 간식을 주세요                               │ │
│  │ 신뢰도 +5 / 광고 1회 시청                                  │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📊 모카와의 추억                                               │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  • 함께한 날: 7일                                               │
│  • 총 쓰다듬기: 45회                                            │
│  • 함께 논 횟수: 15회                                           │
│  • 받은 간식: 8개                                               │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [🏠 공방]  [🧪 제작]  [📋 주문]  [📖 도감]  [🐱 고양이]     │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.7.3 고양이 인터랙션

**[쓰다듬기]**

```
1. 고양이 일러스트 탭
   │
   v
2. 터치 위치에 하트 파티클 생성
   │
   v
3. 고양이 애니메이션 (눈 감기, 편안한 표정)
   │
   v
4. "냐옹~♥" 사운드
   │
   v
5. "+1 신뢰도" 텍스트 애니메이션
   │
   v
6. 상단 신뢰도 바 증가 (0.3초 애니메이션)
   │
   v
7. (1초 쿨다운)
```

**[함께 놀기 - 미니게임]**

```
1. [함께 놀기] 버튼 클릭
   │
   v
2. 미니게임 선택 (MVP: 1종류만)
   "실뭉치 굴리기"
   │
   v
3. MiniGameScene 전환
   │
   ├─ 화면에 실뭉치 등장
   ├─ 터치로 실뭉치 굴리기
   ├─ 고양이가 따라가며 놀기
   └─ 30초 제한 시간
   │
   v
4. 게임 종료
   │
   v
5. 점수에 따라 보너스 신뢰도
   │
   ├─ 0-30점: +10 신뢰도
   ├─ 31-60점: +15 신뢰도
   └─ 61-100점: +20 신뢰도
   │
   v
6. (CatScene 복귀)
```

---

### S08: InventoryModal (모달)

#### 4.8.1 목적
- 보유 아이템 확인
- 빠른 판매
- 재료 사용 (제작 시)

#### 4.8.2 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  인벤토리                                              [✖️ 닫기] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [재료] [완성품]  ← 탭 전환                                     │
│                                                                 │
│  용량: 150 / 200                                  [확장하기 💎] │
│  ■■■■■■■■■■■■■■■□□□□□ 75%                           │
│                                                                 │
│  [정렬: Tier순 ▼]  [필터: 전체 ▼]                               │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  Tier 1 재료                                                    │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │ 🌿       │  │ 💧       │  │ 🪨       │  │ 🪵       │      │
│  │ 들풀      │  │ 맑은 물   │  │ 돌멩이    │  │ 나뭇가지  │      │
│  │          │  │          │  │          │  │          │      │
│  │ × 45     │  │ × 23     │  │ × 18     │  │ × 12     │      │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
│                                                                 │
│  ═════════════════���══════════════════════════════════════════  │
│  Tier 2 재료                                                    │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │ 🌸       │  │ 💦       │  │ 🔒       │  │ 🔒       │      │
│  │ 야생화    │  │ 샘물      │  │ 미해금    │  │ 미해금    │      │
│  │          │  │          │  │          │  │          │      │
│  │ × 8      │  │ × 5      │  │ Lv.5     │  │ Lv.5     │      │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
│                                                                 │
│  ... (스크롤)                                                   │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [선택 아이템 판매] [닫기]                                       │
└─────────────────────────────────────────────────────────────────┘
```

**[완성품 탭]**

```
┌─────────────────────────────────────────────────────────────────┐
│  인벤토리 - 완성품                                     [✖️ 닫기] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  [재료] [완성품]  ← 탭 전환                                     │
│                                                                 │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                    │
│  │ 💚       │  │ 💙       │  │ ⚡       │                    │
│  │ 치유 물약 │  │ 마나 물약 │  │ 활력 물약 │                    │
│  │          │  │          │  │          │                    │
│  │ × 5      │  │ × 2      │  │ × 3      │                    │
│  │          │  │          │  │          │                    │
│  │ 💰 50    │  │ 💰 80    │  │ 💰 60    │                    │
│  │          │  │          │  │          │                    │
│  │ [판매]   │  │ [판매]   │  │ [판매]   │                    │
│  └──────────┘  └──────────┘  └──────────┘                    │
│                                                                 │
│  ... (스크롤)                                                   │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  빠른 판매                                                      │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  [모든 Tier 1 물약 판매] (8개, 총 💰 400)                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 4.8.3 컨텍스트별 동작

| 호출 씬 | 모드 | 동작 |
|---------|------|------|
| HomeScene | 일반 | 아이템 조회, 판매 |
| CraftingScene (자유 제작) | 선택 | 재료 선택 → 슬롯 추가 |
| OrdersScene | 일반 | 아이템 조회만 |

---

### S09: UpgradeModal (모달)

#### 4.9.1 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│  공방 업그레이드                                       [✖️ 닫기] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  현재 레벨: 5                                                   │
│  다음 레벨: 6                                                   │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                                                           │ │
│  │              🏠 → 🏠✨                                     │ │
│  │            Lv.5     Lv.6                                  │ │
│  │                                                           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🎁 해금되는 효과                                               │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ✅ 제작 대기열 +1 슬롯 (3 → 4)                                 │
│  ✅ 재료 수집 속도 +10%                                         │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  💰 비용                                                        │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  필요: 8,000 골드                                               │
│  보유: 12,450 골드 ✅                                           │
│                                                                 │
│  업그레이드 후 잔액: 4,450 골드                                  │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                                                           │ │
│  │                  [업그레이드하기]                          │ │
│  │                                                           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │         [전체 업그레이드 트리 보기]                        │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### S13: RecipeDiscoveryScene (특수)

#### 4.13.1 목적
- 새 레시피 발견 축하 연출
- 플레이어에게 성취감 제공
- 레시피 정보 전달

#### 4.13.2 연출 순서

```
┌─────────────────────────────────────────────────────────────────┐
│                  RecipeDiscoveryScene 연출                      │
└─────────────────────────────────────────────────────────────────┘

[Phase 1: 0-1초]
├── 화면 전체 흰색 플래시
├── 가마솥 빛나는 파티클 폭발
└── "띠링!" 사운드

[Phase 2: 1-2초]
├── 레시피 아이콘 중앙 확대 등장
│   (작게 시작 → 크게)
├── 반짝이는 파티클 주변
└── 배경 그라데이션 (골드 → 화이트)

[Phase 3: 2-4초]
├── "새로운 레시피 발견!" 텍스트 페이드인
├── 레시피 이름 표시
│   "💚 하급 치유 물약"
└── 레시피 설명 표시
    "기본적인 상처를 치유하는 물약..."

[Phase 4: 4-6초]
├── 보상 연출
│   ├── "+100 💰 골드" (위에서 떨어짐)
│   ├── "+10 경험치" (빛나며 표시)
│   └── "도감에 등록되었습니다" 메시지
└── 골드 코인 파티클 애니메이션

[Phase 5: 6초~]
├── [확인] 버튼 표시
└── 대기 (사용자 입력 대기)
```

#### 4.13.3 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                                                                 │
│                    ✨✨✨✨✨✨✨                                 │
│                                                                 │
│                  🎉 새로운 레시피 발견! 🎉                      │
│                                                                 │
│                                                                 │
│                     ┌─────────────┐                            │
│                     │             │                            │
│                     │     💚      │                            │
│                     │             │                            │
│                     │ 하급 치유   │                            │
│                     │   물약      │                            │
│                     │             │                            │
│                     └─────────────┘                            │
│                     ✨   ✨   ✨                                │
│                                                                 │
│  "기본적인 상처를 치유하는 물약. 연금술의 시작입니다."           │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  🎁 보상                                                        │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  💰 +100 골드                                                   │
│  ⭐ +10 경험치                                                  │
│  📖 도감에 등록되었습니다                                        │
│                                                                 │
│  ════════════════════════════════════════════════════════════  │
│  📋 레시피 정보                                                 │
│  ════════════════════════════════════════════════════════════  │
│                                                                 │
│  재료: 🌿 들풀 × 2, 💧 맑은 물 × 1                              │
│  제작 시간: 30초                                                 │
│  판매가: 💰 50                                                  │
│                                                                 │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                       [확인]                               │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│                    (화면 탭해도 닫힘)                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. UI 컴포넌트 라이브러리

### 5.1 공통 컴포넌트 목록

| 컴포넌트 ID | 이름 | 용도 | 재사용 횟수 |
|-------------|------|------|-------------|
| C-01 | TopBar | 상단 재화/타이틀 바 | 모든 씬 |
| C-02 | BottomTabBar | 하단 탭 네비게이션 | 메인 5개 씬 |
| C-03 | MaterialIcon | 재료 아이콘 + 수량 | 모든 씬 |
| C-04 | PotionCard | 물약 카드 | Crafting, Codex, Inventory |
| C-05 | CraftingQueueSlot | 제작 슬롯 | Crafting, Home |
| C-06 | OrderCard | 주문 카드 | Orders |
| C-07 | ProgressBar | 진행도 바 | 모든 씬 |
| C-08 | CurrencyDisplay | 재화 표시 | TopBar |
| C-09 | TimerWidget | 타이머 표시 | Crafting, Orders |
| C-10 | NotificationBadge | 알림 배지 | 탭 바, 버튼 |

### 5.2 컴포넌트 상세

#### C-01: TopBar

```dart
class TopBar extends StatelessWidget {
  final String title;
  final int gold;
  final int gems;
  final VoidCallback? onMenuTap;
  final VoidCallback? onGoldTap;
  final VoidCallback? onGemsTap;

  // 사용 예시
  TopBar(
    title: '고양이 연금술 공방',
    gold: 12450,
    gems: 50,
    onMenuTap: () => showSettingsModal(),
    onGoldTap: () => showGoldInfo(),
    onGemsTap: () => showShopModal(),
  )
}
```

UI:
```
┌─────────────────────────────────────────────────────────────────┐
│  [☰]  고양이 연금술 공방          [💰 12,450]  [💎 50]  [⚙️]  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 씬 상태 관리

### 6.1 상태 관리 아키텍처 (Riverpod)

```dart
// providers/game_state_provider.dart

// 글로벌 게임 상태
final gameStateProvider = StateNotifierProvider<GameStateNotifier, GameState>((ref) {
  return GameStateNotifier();
});

class GameState {
  final int gold;
  final int gems;
  final int reputation;
  final int workshopLevel;
  final PlayerProgress progress;

  GameState({...});
}

// 각 씬별 상태
final craftingStateProvider = StateNotifierProvider<CraftingStateNotifier, CraftingState>((ref) {
  return CraftingStateNotifier(ref.watch(gameStateProvider.notifier));
});

final ordersStateProvider = ...;
final catStateProvider = ...;
```

### 6.2 씬 간 데이터 전달

```
[방법 1: Provider 공유]
HomeScene → CraftingScene
     ↓
  gameStateProvider (공통)
     ↓
  데이터 자동 동기화

[방법 2: 내비게이션 파라미터]
CraftingScene → RecipeDiscoveryScene
     ↓
  Navigator.push(
    context,
    RecipeDiscoveryScene(
      recipe: discoveredRecipe,
    ),
  )

[방법 3: EventBus (mg-common-game)]
제작 완료 이벤트 → HomeScene 알림 배지 업데이트
     ↓
  EventBus.instance.fire(CraftingCompleteEvent())
     ↓
  HomeScene이 listen하여 UI 갱신
```

### 6.3 씬 라이프사이클

```dart
class CraftingScene extends ConsumerStatefulWidget {
  @override
  _CraftingSceneState createState() => _CraftingSceneState();
}

class _CraftingSceneState extends ConsumerState<CraftingScene>
    with AutomaticKeepAliveClientMixin {

  // 씬이 탭에서 사라져도 상태 유지
  @override
  bool get wantKeepAlive => true;

  @override
  void initState() {
    super.initState();
    // 씬 초기화
    _loadData();
    _startTimers();
  }

  @override
  void dispose() {
    // 리소스 해제
    _stopTimers();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    super.build(context); // AutomaticKeepAlive
    // UI 빌드
  }
}
```

---

## 7. 부록

### 7.1 씬 개발 체크리스트

```
[ ] S01: SplashScene
    [ ] 로고 애니메이션
    [ ] 로딩 진행도
    [ ] 저장 데이터 로드
    [ ] 씬 전환 로직

[ ] S02: TutorialScene
    [ ] 5단계 구현
    [ ] 가이드 오버레이 시스템
    [ ] 스킵 기능
    [ ] 튜토리얼 완료 처리

[ ] S03: HomeScene
    [ ] 공방 배경
    [ ] 가마솥 위젯
    [ ] 고양이 애니메이션
    [ ] 재료 수집 배너
    [ ] 주문 요약
    [ ] 업그레이드 위젯

[ ] S04: CraftingScene
    [ ] 레시피 모드 구현
    [ ] 자유 제작 모드 구현
    [ ] 제작 대기열 UI
    [ ] 레시피 카드 그리드
    [ ] 필터/정렬 기능

[ ] S05: OrdersScene
    [ ] 주문 카드 목록
    [ ] 타이머 시스템
    [ ] 납품 플로우
    [ ] 보상 연출

[ ] S06: CodexScene
    [ ] 레시피 목록
    [ ] 발견/미발견 구분
    [ ] 힌트 시스템
    [ ] 통계 표시

[ ] S07: CatScene
    [ ] 고양이 일러스트
    [ ] 쓰다듬기 인터랙션
    [ ] 레벨/스킬 시스템
    [ ] 미니게임

[ ] S08: InventoryModal
    [ ] 재료/완성품 탭
    [ ] 아이템 그리드
    [ ] 판매 기능
    [ ] 용량 표시

[ ] S09: UpgradeModal
    [ ] 레벨 정보
    [ ] 효과 미리보기
    [ ] 업그레이드 버튼

[ ] S13: RecipeDiscoveryScene
    [ ] 연출 애니메이션
    [ ] 보상 표시
    [ ] 레시피 정보
```

### 7.2 씬 전환 애니메이션

| 전환 타입 | 애니메이션 | 지속 시간 |
|-----------|-----------|-----------|
| 탭 전환 | Fade | 200ms |
| 모달 열기 | Slide from bottom + Fade | 300ms |
| 모달 닫기 | Slide to bottom + Fade | 250ms |
| 특수 씬 (발견) | Scale + Fade + Particles | 500ms |
| 특수 씬 (레벨업) | Explosion particles | 300ms |

### 7.3 성능 고려사항

```
[메모리 관리]
├── 탭 씬은 AutomaticKeepAlive로 캐시
├── 모달은 닫을 때 dispose
├── 이미지 리소스 프리로드 (Splash에서)
└── 사용하지 않는 씬 unload (3개 이상 스택 시)

[렌더링 최적화]
├── 리스트는 ListView.builder 사용
├── 이미지는 CachedNetworkImage (로컬 캐시)
├── 애니메이션은 RepaintBoundary로 분리
└── 60 FPS 타겟 유지

[로딩 시간]
├── Splash: < 2초
├── 씬 전환: < 300ms
├── 모달 열기: < 200ms
└── 데이터 로드: 비동기 처리 (로딩 인디케이터)
```

---

**END OF DOCUMENT**

다음: MG-0004, MG-0025 씬 구조 문서 작성
